{% extends "layout.html" %}
{% block title %}{{vehicle.fields.name}} - Belle Vitesse{% endblock %}
{% block content %}
<section id="hero-banner" class="section-site">
    <div class="vehicle-hero-banner bg-color-white-3">
        <img src="{{ vehicle.fields.banner[0].thumbnails.full.url }}" />
        <div class="vehicle-hero-banner-titlewrapper">
            <h1 class="vehicle-hero-banner-titlewrapper-title font-54 color-grey-1">
                {{ vehicle.fields.name }}
            </h1>
        </div>
        <div class="vehicle-hero-banner-textwrapper">
            <p class="vehicle-hero-banner-textwrapper-text font-14 color-grey-1 font-weight-400">
                {{ vehicle.fields.powerquote| safe }}
            </p>
        </div>
</section>
<section class="section-site">
    <div class="vehicle-description">
        <div class="vehicle-description-title">
            <h2 class="dot-before title-section font-32">Description</h2>
        </div>
        <div class="vehicle-description-wrapper">
            <div class="vehicle-description-right">
                <div class="splide" aria-label="Splide Basic HTML Example">
                    <div class="splide__track">
                        <ul class="splide__list">
                            {% for image in vehicle.fields.gallery %}
                            <li class="splide__slide"><img src="{{ image.thumbnails.full.url }}" alt="Gallery image" />
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
            <div class="vehicle-description-left">
                <p class="font-16">{{ vehicle.fields.description }}</p>
            </div>
        </div>
    </div>
</section>
<section class="section-site">
    <div class="vehicle-key_features">
        <div class="vehicle-key_features-title">
            <h2 class="dot-before title-section font-32">Key Features</h2>

        </div>
        <div>
            <div class="vehicle-squared-highlight">
                <div class="vehicle-squared-highlight-wrapper">
                    <div class="vehicle-squared-highlight-wrapper-square">
                        <p class="vehicle-squared-highlight-wrapper-square-value count-up"
                            data-target="{{ vehicle.fields.max_speed }}" data-duration="1000">{{
                            vehicle.fields.max_speed }}</p>
                        <p class="vehicle-squared-highlight-wrapper-square-unit">km/h</p>
                        <p class="vehicle-squared-highlight-wrapper-square-label">Max speed</p>
                    </div>
                    <div class="vehicle-squared-highlight-wrapper-square">
                        <p class="vehicle-squared-highlight-wrapper-square-value">
                            <span>1</span>{% if vehicle.fields.passengers != 0 %}<span
                                class="vehicle-squared-highlight-wrapper-square-value-plussign">+</span><span class=""
                                data-target="{{vehicle.fields.passengers }}" data-duration="1500">{{
                                vehicle.fields.passengers }}</span>{% endif %}
                        </p>
                        <p class="vehicle-squared-highlight-wrapper-square-unit">{% if vehicle.fields.passengers == 0
                            %}Driver{% elif vehicle.fields.passengers == 1 %}Driver + Passenger{% else %}Driver +
                            Passengers{% endif %}</p>
                        <p class="vehicle-squared-highlight-wrapper-square-label">Capacity</p>
                    </div>
                </div>
            </div>
        </div>
</section>
{% if configs_grouped %}
<section class="section-site">
    <div class="vehicle-configurator">
        <h2 class="dot-before title-section font-32">Configurations</h2>
        <div class="vehicle-configurator-carousel-wrapper" x-data="carousel()">
            <div class="vehicle-configurator-carousel-wrapper-config">
                {% for type_name, items in configs_grouped.items() %}
                <div class="vehicle-configurator-carousel-wrapper-config-group">
                    <h3 class="title-section font-24">{{ type_name }}</h3>
                    <nav class="vehicle-configurator-carousel-wrapper-config-list">
                        <template x-for="(item, index) in itemsByType['{{ type_name }}']" :key="index">
                            <button class="vehicle-configurator-carousel-wrapper-config-item"
                                :class="{ 'active': activeIndex === getGlobalIndex('{{ type_name }}', index), 'inactive': activeIndex !== getGlobalIndex('{{ type_name }}', index) }"
                                @click="activeIndex = getGlobalIndex('{{ type_name }}', index)"
                                x-text="item.label"></button>
                        </template>
                    </nav>
                </div>
                {% endfor %}
            </div>
            <div class="vehicle-configurator-carousel-wrapper-img-container">
                <img :src="allItems[activeIndex].image" :alt="allItems[activeIndex].label">
            </div>
        </div>
    </div>
</section>
{% endif %}
<section class="section-site">
    <div class="vehicle-specs">
        <h2 class="vehicle-specs-title dot-before title-section font-32">Technical specifications</h2>
        <div class="vehicle-specs-details">
            <div>
                {% for label, value in specs_left.items() %}
                <div class="vehicle-specs-details-detail-wrapper">
                    <p>{{ label }} :</p>
                    <div class="vehicle-specs-details-detail-wrapper-value">
                        <p>{{ value }}</p>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div>
                {% for label, value in specs_right.items() %}
                <div class="vehicle-specs-details-detail-wrapper">
                    <p>{{ label }} :</p>
                    <div class="vehicle-specs-details-detail-wrapper-value">
                        <p>{{ value }}</p>
                    </div>
                </div>
                {% endfor %}
            </div>

        </div>

        <div class="vehicle-specs-diagram-wrapper">

            <div class="vehicle-specs-diagram-wrapper-sideview"><img
                    src="{{ vehicle.fields.blueprint_side[0].thumbnails.full.url }}" /></div>
            <div class="vehicle-specs-diagram-wrapper-topview"><img
                    src="{{ vehicle.fields.blueprint_top[0].thumbnails.full.url }}" /></div>
        </div>
    </div>
</section>
<script>
    function carousel() {
        return {
            activeIndex: 0,
            allItems: [
                {% for type_name, items in configs_grouped.items() %}
        {% for config in items %}
        {
            label: "{{ config.fields.name }}",
                image: "{{ config.fields.image[0].thumbnails.large.url }}"
        },
        {% endfor %}
        {% endfor %}
            ],
        itemsByType: {
            {% for type_name, items in configs_grouped.items() %}
            "{{ type_name }}": [
                {% for config in items %}
        {
            label: "{{ config.fields.name }}",
                image: "{{ config.fields.image[0].thumbnails.large.url }}"
        },
        {% endfor %}
                ],
        {% endfor %}
    },
    getGlobalIndex(type, localIndex) {
        let count = 0;
        for (let t in this.itemsByType) {
            if (t === type) return count + localIndex;
            count += this.itemsByType[t].length;
        }
        return 0;
    }
        }
    }
</script>
{% endblock %}